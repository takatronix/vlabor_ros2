profile:
  name: so101_single_teleop
  description: "Single-arm teleop (leader->follower) + overhead camera"
  devices:
    - key: left_serial_port
      label: "左アーム (follower) シリアルポート"
      type: serial
      default: "/dev/ttyACM0"
    - key: right_serial_port
      label: "右アーム (leader) シリアルポート"
      type: serial
      default: "/dev/ttyACM1"
  actions:
    - type: include
      package: fv_camera
      launch: fv_camera_launch.py
      args:
        node_name: overhead_camera
        config_file: ${overhead_camera_config}
    - type: include
      package: lerobot_recorder
      launch: episode_recorder.launch.py
      args:
        preset: so101_single_vr
    - type: node
      package: unity_robot_control
      executable: joint_state_mirror_node
      name: joint_state_mirror_single
      parameters:
        config_file: ${mirror_single_config}
    - type: include
      package: so101_description
      launch: rsp.launch.py
      args:
        model: ${so101_urdf_path}
        mode: real
        type: left_arm
        tf_offset_x: "0.0"
        tf_offset_y: "0.15"
        tf_offset_z: "0.0"
    - type: include
      package: so101_description
      launch: rsp.launch.py
      args:
        model: ${so101_urdf_path}
        mode: real
        type: right_arm
        tf_offset_x: "0.0"
        tf_offset_y: "-0.15"
        tf_offset_z: "0.0"
    - type: node
      package: unity_robot_control
      executable: so101_control_node
      name: so101_control_node
      namespace: left_arm
      parameters:
        serial_port: ${left_serial_port}
        calibration_path: ${left_calibration_path}
        driver_backend: ${driver_backend}
        auto_enable: true
        gripper_scale: ${gripper_scale}
        urdf_path: ${so101_urdf_path}
    - type: node
      package: unity_robot_control
      executable: so101_control_node
      name: so101_control_node
      namespace: right_arm
      parameters:
        serial_port: ${right_serial_port}
        calibration_path: ${right_calibration_path}
        driver_backend: ${driver_backend}
        auto_enable: false
        gripper_scale: ${gripper_scale}
        urdf_path: ${so101_urdf_path}
    - type: node
      package: unity_robot_control
      executable: so101_webui_node
      name: so101_webui_left
      parameters:
        web_port: ${left_webui_port}
        arm_namespaces: [left_arm]
    - type: node
      package: vlabor_dashboard
      executable: vlabor_dashboard_node
      name: vlabor_dashboard
      parameters:
        web_port: ${dashboard_port}
        profile: so101_single_teleop
        arm_namespaces: [left_arm]
        webui_ports: ["${left_webui_port}"]
        camera_topics: [/overhead_camera/image_raw]
        camera_names: [overhead_camera]
    - type: include
      package: foxglove_bridge
      launch: foxglove_bridge_launch.xml
      enabled: ${enable_foxglove}
    - type: include
      package: so101_description
      launch: display.launch.py
      args:
        display_config: ${rviz_vr_config}
